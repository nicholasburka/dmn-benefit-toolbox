<?xml version="1.0" encoding="UTF-8"?>
<dmn:definitions xmlns:dmn="http://www.omg.org/spec/DMN/20180521/MODEL/"
                 xmlns="https://kie.apache.org/dmn/_7E8F9A0B-1C2D-3E4F-5A6B-7C8D9E0F1A2B"
                 xmlns:feel="http://www.omg.org/spec/DMN/20180521/FEEL/"
                 xmlns:kie="http://www.drools.org/kie/dmn/1.2"
                 xmlns:dmndi="http://www.omg.org/spec/DMN/20180521/DMNDI/"
                 id="_8F9A0B1C-2D3E-4F5A-6B7C-8D9E0F1A2B3C"
                 name="SsiIncomeLimit"
                 typeLanguage="http://www.omg.org/spec/DMN/20180521/FEEL/"
                 namespace="https://kie.apache.org/dmn/_7E8F9A0B-1C2D-3E4F-5A6B-7C8D9E0F1A2B">

  <dmn:description>POMS SI 00810.000 - SSI income limit check: countable income must be less than Federal Benefit Rate (FBR).

2025 FBR rates:
- Individual: $967/month
- Couple: $1,450/month

Wrapper check that uses CalculateCountableIncome to apply all income exclusions and compare to FBR.</dmn:description>

  <!-- Import BDT base module -->
  <dmn:import id="_9A0B1C2D-3E4F-5A6B-7C8D-9E0F1A2B3C4D"
              name="BDT"
              namespace="https://kie.apache.org/dmn/_1B91A885-130A-4E0B-A762-E12AA6DD5C79"
              locationURI="../../BDT.dmn"
              importType="http://www.omg.org/spec/DMN/20180521/MODEL/"/>

  <!-- Import CalculateCountableIncome decision -->
  <dmn:import id="_A0B1C2D3-4E5F-6A7B-8C9D-0E1F2A3B4CZZ"
              name="CalculateCountableIncome"
              namespace="https://kie.apache.org/dmn/_5C6D7E8F-9A0B-1C2D-3E4F-5A6B7C8D9E0F"
              locationURI="calculate-countable-income.dmn"
              importType="http://www.omg.org/spec/DMN/20180521/MODEL/"/>

  <!-- Parameters type definition -->
  <dmn:itemDefinition id="_B1C2D3E4-5F6A-7B8C-9D0E-1F2A3B4C5D6E" name="tParameters" isCollection="false">
    <dmn:itemComponent id="_C2D3E4F5-6A7B-8C9D-0E1F-2A3B4C5D6E7F" name="personId" isCollection="false">
      <dmn:typeRef>string</dmn:typeRef>
    </dmn:itemComponent>
    <dmn:itemComponent id="_D3E4F5A6-7B8C-9D0E-1F2A-3B4C5D6E7F8A" name="FBR" isCollection="false">
      <dmn:typeRef>number</dmn:typeRef>
    </dmn:itemComponent>
  </dmn:itemDefinition>

  <!-- Input: situation -->
  <dmn:inputData id="_E4F5A6B7-8C9D-0E1F-2A3B-4C5D6E7F8A9B" name="situation">
    <dmn:extensionElements/>
    <dmn:variable id="_F5A6B7C8-9D0E-1F2A-3B4C-5D6E7F8A9B0C"
                  name="situation"
                  typeRef="BDT.tSituation"/>
  </dmn:inputData>

  <!-- Input: parameters -->
  <dmn:inputData id="_A6B7C8D9-0E1F-2A3B-4C5D-6E7F8A9B0C1D" name="parameters">
    <dmn:extensionElements/>
    <dmn:variable id="_B7C8D9E0-1F2A-3B4C-5D6E-7F8A9B0C1D2E"
                  name="parameters"
                  typeRef="tParameters"/>
  </dmn:inputData>

  <!-- Decision: checkResult -->
  <dmn:decision id="_C8D9E0F1-2A3B-4C5D-6E7F-8A9B0C1D2E3F" name="checkResult">
    <dmn:description>POMS SI 00810.000: Countable income must be less than FBR ($967 individual, $1,450 couple)</dmn:description>
    <dmn:extensionElements/>
    <dmn:variable id="_D9E0F1A2-3B4C-5D6E-7F8A-9B0C1D2E3F4A"
                  name="checkResult"
                  typeRef="boolean"/>
    <dmn:informationRequirement id="_E0F1A2B3-4C5D-6E7F-8A9B-0C1D2E3F4A5B">
      <dmn:requiredInput href="#_E4F5A6B7-8C9D-0E1F-2A3B-4C5D6E7F8A9B"/>
    </dmn:informationRequirement>
    <dmn:informationRequirement id="_F1A2B3C4-5D6E-7F8A-9B0C-1D2E3F4A5B6C">
      <dmn:requiredInput href="#_A6B7C8D9-0E1F-2A3B-4C5D-6E7F8A9B0C1D"/>
    </dmn:informationRequirement>

    <dmn:context id="_A2B3C4D5-6E7F-8A9B-0C1D-2E3F4A5B6C7D">
      <!-- Step 1: Calculate countable income -->
      <dmn:contextEntry>
        <dmn:variable id="_B3C4D5E6-7F8A-9B0C-1D2E-3F4A5B6C7D8E" name="calculation" typeRef="BDT.tIncomeCalculation"/>
        <dmn:invocation id="_C4D5E6F7-8A9B-0C1D-2E3F-4A5B6C7D8E9F">
          <dmn:literalExpression id="_D5E6F7A8-9B0C-1D2E-3F4A-5B6C7D8E9F0A">
            <dmn:text>CalculateCountableIncome.CalculateCountableIncomeService</dmn:text>
          </dmn:literalExpression>
          <dmn:binding>
            <dmn:parameter id="_E6F7A8B9-0C1D-2E3F-4A5B-6C7D8E9F0A1B" name="situation" typeRef="BDT.tSituation"/>
            <dmn:literalExpression id="_F7A8B9C0-1D2E-3F4A-5B6C-7D8E9F0A1B2C">
              <dmn:text>situation</dmn:text>
            </dmn:literalExpression>
          </dmn:binding>
          <dmn:binding>
            <dmn:parameter id="_A8B9C0D1-2E3F-4A5B-6C7D-8E9F0A1B2C3D" name="parameters" typeRef="CalculateCountableIncome.tParameters"/>
            <dmn:literalExpression id="_B9C0D1E2-3F4A-5B6C-7D8E-9F0A1B2C3D4E">
              <dmn:text>parameters</dmn:text>
            </dmn:literalExpression>
          </dmn:binding>
        </dmn:invocation>
      </dmn:contextEntry>

      <!-- Step 2: Extract result -->
      <dmn:contextEntry>
        <dmn:variable id="_C0D1E2F3-4A5B-6C7D-8E9F-0A1B2C3D4E5F" name="result" typeRef="boolean"/>
        <dmn:literalExpression id="_D1E2F3A4-5B6C-7D8E-9F0A-1B2C3D4E5F6A">
          <dmn:text>calculation.meetsIncomeLimit</dmn:text>
        </dmn:literalExpression>
      </dmn:contextEntry>

      <!-- Step 3: Return result -->
      <dmn:contextEntry>
        <dmn:literalExpression id="_E2F3A4B5-6C7D-8E9F-0A1B-2C3D4E5F6A7B">
          <dmn:text>result</dmn:text>
        </dmn:literalExpression>
      </dmn:contextEntry>
    </dmn:context>
  </dmn:decision>

  <!-- Decision Service -->
  <dmn:decisionService id="_F3A4B5C6-7D8E-9F0A-1B2C-3D4E5F6A7B8C" name="SsiIncomeLimitService">
    <dmn:extensionElements/>
    <dmn:variable id="_A4B5C6D7-8E9F-0A1B-2C3D-4E5F6A7B8C9D"
                  name="SsiIncomeLimitService"
                  typeRef="BDT.tCheckResponse"/>
    <dmn:outputDecision href="#_C8D9E0F1-2A3B-4C5D-6E7F-8A9B0C1D2E3F"/>
    <dmn:inputData href="#_E4F5A6B7-8C9D-0E1F-2A3B-4C5D6E7F8A9B"/>
    <dmn:inputData href="#_A6B7C8D9-0E1F-2A3B-4C5D-6E7F8A9B0C1D"/>
  </dmn:decisionService>

</dmn:definitions>
