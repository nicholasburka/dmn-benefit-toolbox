meta {
  name: Couple - One Fails Categorical
  type: http
  seq: 22
}

post {
  url: {{host}}/benefits/federal/ssi-eligibility
  body: json
  auth: inherit
}

body:json {
  {
    "situation": {
      "evaluationDate": "2025-01-01",
      "primaryPersonId": "p1",
      "people": [
        {
          "id": "p1",
          "dateOfBirth": "1955-06-15",
          "citizenshipStatus": "US_CITIZEN",
          "isBlindOrDisabled": false,
          "residenceState": "PA",
          "countableResources": 1500,
          "incomeSources": [
            {
              "id": "inc1",
              "type": "unearned",
              "category": "SSA",
              "monthlyAmount": 800,
              "description": "Social Security benefits",
              "isInfrequentOrIrregular": false
            }
          ]
        },
        {
          "id": "p2",
          "dateOfBirth": "1995-03-20",
          "citizenshipStatus": "US_CITIZEN",
          "isBlindOrDisabled": false,
          "residenceState": "PA",
          "countableResources": 0,
          "incomeSources": []
        }
      ],
      "enrollments": [],
      "relationships": [
        {
          "type": "spouse",
          "personId": "p1",
          "relatedPersonId": "p2"
        }
      ],
      "simpleChecks": {}
    }
  }
}

assert {
  res.status: eq 200
  res.body.checks.categoricalEligible: eq true
  res.body.checks.citizenshipEligible: eq true
  res.body.checks.spouseCategoricalEligible: eq false
  res.body.checks.spouseCitizenshipEligible: eq true
  res.body.checks.isCouple: eq false
  res.body.checks.residenceEligible: eq true
  res.body.checks.resourceEligible: eq true
  res.body.checks.incomeEligible: eq true
  res.body.isEligible: eq true
}

settings {
  encodeUrl: true
  timeout: 0
}
